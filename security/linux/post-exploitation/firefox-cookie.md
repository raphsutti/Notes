# Firefox cookie

## Cookie count
```
student@attackdefense:~/.mozilla/firefox/zevp8nk2.default$ sqlite3 cookies.sqlite
SQLite version 3.11.0 2016-02-15 17:29:24
Enter ".help" for usage hints.
sqlite> .tables
moz_cookies
sqlite> select count(*) from moz_cookies;
324
sqlite> select count(*) from moz_cookies where baseDomain="nytimes.com";
19

sqlite> .schema moz_cookies
CREATE TABLE moz_cookies (id INTEGER PRIMARY KEY, baseDomain TEXT, originAttributes TEXT NOT NULL DEFAULT '', name TEXT, value TEXT, host TEXT, path TEXT, expiry INTEGER, lastAccessed INTEGER, creationTime INTEGER, isSecure INTEGER, isHttpOnly INTEGER, inBrowserElement INTEGER DEFAULT 0, sameSite INTEGER DEFAULT 0, CONSTRAINT moz_uniqueid UNIQUE (name, host, path, originAttributes));
CREATE INDEX moz_basedomain ON moz_cookies (baseDomain, originAttributes);
```

## Cookies from bing.com
```
sqlite> select * from moz_cookies where baseDomain="bing.com";
77|bing.com||MR|0|.bat.bing.com|/|1555286276|1539736294240496|1539733489864225|0|0|0|0
917|bing.com||MUIDB|04ADB6141BA2699F35BCBA9E1FA26A80|bat.bing.com|/|1573432931|1539736294240496|1539736146869416|0|1|0|0
1175|bing.com||ANONCHK|1|.c.bing.com|/|1539739197|1539738597804097|1539738597804097|0|0|0|0
1176|bing.com||MUID|04ADB6141BA2699F35BCBA9E1FA26A80|.bing.com|/|1573434597|1539738597804183|1539733489864149|0|0|0|0
1177|bing.com||MR|0|.c.bing.com|/|1555290597|1539738597804216|1539738597804216|0|0|0|0
1178|bing.com||MUIDB|04ADB6141BA2699F35BCBA9E1FA26A80|c.bing.com|/|1573434597|1539738597804254|1539738597804254|0|1|0|0
sqlite>
```

## Cookies accessed most recently
```
sqlite> select * from moz_cookies where (lastAccessed) in (select max(lastAccessed) from moz_cookies);
425|facebook.com||sb|uXzGW3NTY-7fDjVrWLNi2fAK|.facebook.com|/|1602805927|1539738614018786|1539733928044516|1|1|0|0
435|facebook.com||datr|uXzGWwr4H0NQWmF-o8FLPn6G|.facebook.com|/|1602805939|1539738614018786|1539733939694772|1|1|0|0
1147|facebook.com||fr|0xeMXHKcJlUf4YFeM..BbxnsE.dm.FvG.0.0.Bbxou1.AWUIsIxl|.facebook.com|/|1547514549|1539738614018786|1539733490377637|1|1|0|0
```

## Valid cookies from 1/1/2019
```
student@attackdefense:~/.mozilla/firefox/zevp8nk2.default$ date "+%s" -d "01/01/2019 00:00:00"
1546300800

sqlite> select count(*) from moz_cookies where expiry > 1546300800;
217
```
