# Firefox history

## Which travel website the user used to check for flights?

`booking.com`
```
student@attackdefense:~$ cd .mozilla/firefox/zevp8nk2.default/
.parentlock                   browser-extension-data/       extensions/                   logins.json                   saved-telemetry-pings/        storage-sync.sqlite
AlternateServices.txt         cert9.db                      extensions.json               minidumps/                    search.json.mozlz4            storage.sqlite
SecurityPreloadState.txt      compatibility.ini             favicons.sqlite               permissions.sqlite            serviceworker.txt             times.json
SiteSecurityServiceState.txt  containers.json               formhistory.sqlite            persdict.dat                  sessionCheckpoints.json       weave/
addonStartup.json.lz4         content-prefs.sqlite          gmp/                          pkcs11.txt                    sessionstore-backups/         webappsstore.sqlite
addons.json                   cookies.sqlite                gmp-gmpopenh264/              places.sqlite                 sessionstore.jsonlz4          xulstore.json
blocklist.xml                 crashes/                      handlers.json                 pluginreg.dat                 shield-recipe-client.json
blocklists/                   datareporting/                key4.db                       prefs.js                      signedInUser.json
bookmarkbackups/              enumerate_devices.txt         kinto.sqlite                  revocations.txt               storage/
student@attackdefense:~$ cd .mozilla/firefox/zevp8nk2.default/
.parentlock                   browser-extension-data/       extensions/                   logins.json                   saved-telemetry-pings/        storage-sync.sqlite
AlternateServices.txt         cert9.db                      extensions.json               minidumps/                    search.json.mozlz4            storage.sqlite
SecurityPreloadState.txt      compatibility.ini             favicons.sqlite               permissions.sqlite            serviceworker.txt             times.json
SiteSecurityServiceState.txt  containers.json               formhistory.sqlite            persdict.dat                  sessionCheckpoints.json       weave/
addonStartup.json.lz4         content-prefs.sqlite          gmp/                          pkcs11.txt                    sessionstore-backups/         webappsstore.sqlite
addons.json                   cookies.sqlite                gmp-gmpopenh264/              places.sqlite                 sessionstore.jsonlz4          xulstore.json
blocklist.xml                 crashes/                      handlers.json                 pluginreg.dat                 shield-recipe-client.json
blocklists/                   datareporting/                key4.db                       prefs.js                      signedInUser.json
bookmarkbackups/              enumerate_devices.txt         kinto.sqlite                  revocations.txt               storage/
student@attackdefense:~$ cd .mozilla/firefox/zevp8nk2.default/
student@attackdefense:~/.mozilla/firefox/zevp8nk2.default$ sqlite3 places.sqlite
SQLite version 3.11.0 2016-02-15 17:29:24
Enter ".help" for usage hints.
sqlite> .tables
moz_anno_attributes    moz_historyvisits      moz_keywords
moz_annos              moz_hosts              moz_places
moz_bookmarks          moz_inputhistory
moz_bookmarks_deleted  moz_items_annos
sqlite> select * from moz_places
   ...> ;
1|https://support.mozilla.org/en-US/products/firefox||gro.allizom.troppus.|0|0|0|137||iZpT3cYccuf2|1|47357795150914||

...

35|https://booking.kayak.com/flights/SFO-AMS/2018-11-16/2018-11-16|SFO to AMS, 11/16 — 11/16|moc.kayak.gnikoob.|1|0|0|98|1539733784949166|EC9iuzZjej-8|0|47358259728303|Booking.com searches hundreds of flight sites at once to find the information you need to make the right decisions on flights.|https://booking.kayak.com/rimg/dimg/92/c5/5687cba1-city-1334-162d3e56fea.jpg?width=1200&height=630&crop=true&xhint=1873&yhint=1504

```

## Which was the destination country for which the user checked/booked the flights?

AMS - Netherlands
```
35|https://booking.kayak.com/flights/SFO-AMS/2018-11-16/2018-11-16|SFO to AMS, 11/16 — 11/16|moc.kayak.gnikoob.|1|0|0|98|1539733784949166|EC9iuzZjej-8|0|47358259728303|Booking.com searches hundreds of flight sites at once to find the information you need to make the right decisions on flights.|https://booking.kayak.com/rimg/dimg/92/c5/5687cba1-city-1334-162d3e56fea.jpg?width=1200&height=630&crop=true&xhint=1873&yhint=1504
```

## Which website was opened last?

nytimes

```
125|https://www.nytimes.com/|The New York Times - Breaking News, World News & Multimedia|moc.semityn.www.|1|0|0|2000|1539738568149660|61fJetiTErWf|0|47360170288137|The New York Times: Find breaking news, multimedia, reviews & opinion on Washington, business, sports, movies, travel, books, jobs, education, real estate, cars & more at nytimes.com.|https://static01.nyt.com/newsgraphics/images/icons/defaultPromoCrop.png
```

## What is the name (complete name with extension) of the torrent file downloaded bythe user?

ubuntu-18.04.1-desktop-amd64.iso.torrent

```
sqlite> select * from moz_places where url like '%torrent%';
76|https://www.google.com/search?client=ubuntu&channel=fs&q=downoad+ubuntu+torrent&ie=utf-8&oe=utf-8|downoad ubuntu torrent - Google Search|moc.elgoog.www.|1|0|1|2000|1539735035304558|R8fxVxHEtNH5|0|47358975148251||
78|http://releases.ubuntu.com/18.04/ubuntu-18.04.1-desktop-amd64.iso.torrent?_ga=2.212506516.1453540542.1539735050-487258626.1539735050|ubuntu-18.04.1-desktop-amd64.iso.torrent|moc.utnubu.sesaeler.|0|0|0|0|1539735107178000|iDCEz_2gETo_|0|125509217591951||
```

Also found here
```
sqlite> select * from moz_annos;
1|12|5|UTF-8|0|4|3|1539646978768000|1539646978768000
2|15|5|UTF-8|0|4|3|1539650024946000|1539650024946000
3|23|5|UTF-8|0|4|3|1539732744919000|1539732744919000
4|26|5|UTF-8|0|4|3|1539732876149000|1539732876149000
5|28|5|UTF-8|0|4|3|1539733372952000|1539733372952000
6|75|7|file:///home/pentester/Downloads/80211-05_0123r1(1).pdf|0|5|3|1539735004808000|1539735015175000
7|75|8|{"state":1,"endTime":1539735015402,"fileSize":924274}|0|5|3|1539735005256000|1539735015402000
8|78|7|file:///tmp/mozilla_pentester0/ubuntu-18.04.1-desktop-amd64.iso-1.torrent|0|5|3|1539735070922000|1539735107201000
9|78|8|{"state":1,"endTime":1539735107238,"fileSize":74860}|0|5|3|1539735071277000|1539735107240000
```

## How many unique hosts (sub-domains) were accessed using Firefox?

36
```
sqlite> select count(*) from moz_hosts;
36
```

## How many files the user downloaded using Firefox?

2
```
sqlite> select * from moz_annos;
1|12|5|UTF-8|0|4|3|1539646978768000|1539646978768000
2|15|5|UTF-8|0|4|3|1539650024946000|1539650024946000
3|23|5|UTF-8|0|4|3|1539732744919000|1539732744919000
4|26|5|UTF-8|0|4|3|1539732876149000|1539732876149000
5|28|5|UTF-8|0|4|3|1539733372952000|1539733372952000
6|75|7|file:///home/pentester/Downloads/80211-05_0123r1(1).pdf|0|5|3|1539735004808000|1539735015175000
7|75|8|{"state":1,"endTime":1539735015402,"fileSize":924274}|0|5|3|1539735005256000|1539735015402000
8|78|7|file:///tmp/mozilla_pentester0/ubuntu-18.04.1-desktop-amd64.iso-1.torrent|0|5|3|1539735070922000|1539735107201000
9|78|8|{"state":1,"endTime":1539735107238,"fileSize":74860}|0|5|3|1539735071277000|1539735107240000
```

## How many time target user accessed ​https://facebook.com​ from the browser

2

```
41|https://facebook.com/||moc.koobecaf.|2|1|0|50|1539738549399943|8KXiSRDR78Fi|0|47356606673666||
42|https://www.facebook.com/|Facebook - Log In or Sign Up|moc.koobecaf.www.|2|0|0|90|1539738549815920|td_PQZ_53e90|0|47358661893743|Create an account or log into Facebook. Connect with friends, family and other people you know. Share photos and videos, send messages and get updates.|https://www.facebook.com/images/fb_icon_325x325.png

sqlite> select * from moz_historyvisits where place_id=41;
26|25|41|1539733927634366|6|0
127|126|41|1539738549399943|5|0
```

