# Crack bcrypt

- Bcrypt is a popular 184-bit password hashing function designed by Niels Provos and David Mazieres in 1999
- Bcrypt is based on blowfish cipher
- This is default password hashing algorithm for OpenBSD and OS's like SUSE Linux

Convert file to a format for hashcat - [example hashes format](https://hashcat.net/wiki/doku.php?id=example_hashes)
```
cat digest.txt
Digest: gLX3.eb.sPNURq3Y87bx/eUC9Ysw6mZhi1HAWvy07DWYyw9zYI3.W

cat hash
$2a$04$gLX3.eb.sPNURq3Y87bx/eUC9Ysw6mZhi1HAWvy07DWYyw9zYI3.W
```

Run hashcat

Syntax: `hashcat -m 3200 [hash] -a 0 [wordlist]

`-m 3200` : bcrypt
`-a 0` : dictionary attack

```
hashcat -m 3200 hash -a 0 1000000-password-seclists.txt
hashcat (v4.2.1) starting...

OpenCL Platform #1: Intel(R) Corporation
========================================
* Device #1: AMD EPYC 7601 32-Core Processor, 24142/96571 MB allocatable, 48MCU

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers:
* Zero-Byte
* Single-Hash
* Single-Salt

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 72

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.
```

We know the password is only 4 characters long consisting of 0-9a-z

Syntax: `hashcat -m 3200 [hash] -a 3 -1 ?l?d ?1?1?1

`-a 3` : mask mode
`-1 ?l?d ?1?1?1` : l = (a-z), d = (0-9)

```
hashcat -m 3200 hash -a 3 -1 ?l?d ?1?1?1
hashcat (v4.2.1) starting...

OpenCL Platform #1: Intel(R) Corporation
========================================
* Device #1: AMD EPYC 7601 32-Core Processor, 24142/96571 MB allocatable, 48MCU

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates

Applicable optimizers:
* Zero-Byte
* Single-Hash
* Single-Salt
* Brute-Force

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 72

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

$2a$04$gLX3.eb.sPNURq3Y87bx/eUC9Ysw6mZhi1HAWvy07DWYyw9zYI3.W:bdy

Session..........: hashcat
Status...........: Cracked
Hash.Type........: bcrypt $2*$, Blowfish (Unix)
Hash.Target......: $2a$04$gLX3.eb.sPNURq3Y87bx/eUC9Ysw6mZhi1HAWvy07DWY...zYI3.W
Time.Started.....: Thu Apr  1 12:37:50 2021 (28 secs)
Time.Estimated...: Thu Apr  1 12:38:18 2021 (0 secs)
Guess.Mask.......: ?1?1?1 [3]
Guess.Charset....: -1 ?l?d, -2 Undefined, -3 Undefined, -4 Undefined
Guess.Queue......: 1/1 (100.00%)
Speed.Dev.#1.....:      554 H/s (37.18ms) @ Accel:1 Loops:1 Thr:8 Vec:8
Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts
Progress.........: 15744/46656 (33.74%)
Rejected.........: 0/15744 (0.00%)
Restore.Point....: 384/1296 (29.63%)
Candidates.#1....: bpt -> bn1
HWMon.Dev.#1.....: N/A

Started: Thu Apr  1 12:37:23 2021
Stopped: Thu Apr  1 12:38:20 2021
```
