# Cracking winzip password

## Using John
First you need to convert the file to a something John the Ripper understands
```
zip2john archive.zip > hash
ver 2.0 archive.zip->token.txt PKZIP Encr: cmplen=60, decmplen=32, crc=35ABFDE6
```

Start cracking

Syntax: `john --wordlist=[wordlist] [hash]`

```
john --wordlist=1000000-password-seclists.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 48 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
midnight         (archive.zip)
1g 0:00:00:16 DONE (2021-04-01 11:51) 0.06211g/s 6105p/s 6105c/s 6105C/s 123456..231158
Use the "--show" option to display all of the cracked passwords reliably
Session completed
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])
Will run 48 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
midnight         (archive.zip)
1g 0:00:00:16 DONE (2021-04-01 11:51) 0.06211g/s 6105p/s 6105c/s 6105C/s 123456..231158
Use the "--show" option to display all of the cracked passwords reliably
Session completed
```

## Hashcat

First, convert the hash to something hashcat understands

```
cat hash2
$zip2$*0*3*0*4359ff429775624a78816af6d296ef98*42d7*20*5876ee6ac818147d5fb1a98c863d1fcc18f116003eeacbcc272673ce8b96af91*710baaff8d1c4a02ecd7*$/zip2$
```

Run hashcat

Syntax: `hashcat -m 13600 [hash] -a 0 [wordlist]`

`-m 13600` : WinZip format

`-a 0` : Dictionary mode


```
hashcat -m 13600 hash2 -a 0 1000000-password-seclists.txt
hashcat (v4.2.1) starting...

OpenCL Platform #1: Intel(R) Corporation
========================================
* Device #1: AMD EPYC 7601 32-Core Processor, 24142/96571 MB allocatable, 48MCU

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Applicable optimizers:
* Zero-Byte
* Single-Hash
* Single-Salt
* Slow-Hash-SIMD-LOOP

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Dictionary cache built:
* Filename..: 1000000-password-seclists.txt
* Passwords.: 1000003
* Bytes.....: 8529147
* Keyspace..: 1000003
* Runtime...: 0 secs

$zip2$*0*3*0*4359ff429775624a78816af6d296ef98*42d7*20*5876ee6ac818147d5fb1a98c863d1fcc18f116003eeacbcc272673ce8b96af91*710baaff8d1c4a02ecd7*$/zip2$:midnight

Session..........: hashcat
Status...........: Cracked
Hash.Type........: WinZip
Hash.Target......: $zip2$*0*3*0*4359ff429775624a78816af6d296ef98*42d7*.../zip2$
Time.Started.....: Thu Apr  1 11:55:10 2021 (2 secs)
Time.Estimated...: Thu Apr  1 11:55:12 2021 (0 secs)
Guess.Base.......: File (1000000-password-seclists.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.Dev.#1.....:     1621 H/s (51.28ms) @ Accel:64 Loops:31 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts
Progress.........: 3072/1000003 (0.31%)
Rejected.........: 0/3072 (0.00%)
Restore.Point....: 0/1000003 (0.00%)
Candidates.#1....: 123456 -> meghan
HWMon.Dev.#1.....: N/A

Started: Thu Apr  1 11:55:01 2021
Stopped: Thu Apr  1 11:55:13 2021
```
